[r-dev]
# Ubuntu-based R development environment
image=ubuntu:latest
pull=true
replace=true
start_now=false
init=false
root=false

# Core development packages
additional_packages="curl git wget build-essential"

# R and statistical computing dependencies
additional_packages="r-base r-base-dev"
additional_packages="libcurl4-openssl-dev libssl-dev libxml2-dev"
additional_packages="libfontconfig1-dev libharfbuzz-dev libfribidi-dev"
additional_packages="libfreetype6-dev libpng-dev libtiff5-dev libjpeg-dev"
additional_packages="libgdal-dev libproj-dev libgeos-dev"
additional_packages="libudunits2-dev"

# Python for reticulate
additional_packages="python3 python3-pip python3-dev"

# Development utilities
additional_packages="vim nano neovim"
additional_packages="tmux screen"
additional_packages="htop btop tree fd-find ripgrep"
additional_packages="jq yq"
additional_packages="unzip zip tar gzip"

# Network and debugging tools
additional_packages="net-tools iputils-ping dnsutils"

# Version control
additional_packages="git-lfs gh"

# LaTeX for R Markdown
additional_packages="texlive-latex-base texlive-fonts-recommended texlive-latex-extra"

# Setup r2u for fast binary package installation
init_hooks="echo 'DEBUG: Setting up r2u for fast R package installation...'"
init_hooks="apt install --yes --no-install-recommends python3-dbus python3-gi python3-apt"
init_hooks="wget -q -O- https://eddelbuettel.github.io/r2u/assets/dirk_eddelbuettel_key.asc | tee -a /etc/apt/trusted.gpg.d/cranapt_key.asc"
init_hooks="echo 'deb [arch=amd64] https://r2u.stat.illinois.edu/ubuntu jammy main' > /etc/apt/sources.list.d/cranapt.list"
init_hooks="apt update"
init_hooks="echo 'DEBUG: Installing R with r2u integration...'"
init_hooks="apt install --yes --no-install-recommends r-api-4.0 r-cran-bspm"
init_hooks="echo 'DEBUG: Configuring bspm for automatic binary package use...'"
init_hooks="echo 'options(bspm.sudo=TRUE)' >> /etc/R/Rprofile.site"
init_hooks="echo 'bspm::enable()' >> /etc/R/Rprofile.site"
init_hooks="echo 'DEBUG: Installing essential R packages via r2u binaries...'"
init_hooks="R -e \"install.packages(c('devtools', 'tidyverse', 'rmarkdown', 'knitr', 'shiny', 'plotly', 'DT'))\""
init_hooks="echo 'DEBUG: Installing data science packages...'"
init_hooks="R -e \"install.packages(c('caret', 'randomForest', 'ggplot2', 'dplyr', 'readr', 'lubridate'))\""
init_hooks="echo 'DEBUG: Installing development tools...'"
init_hooks="R -e \"install.packages(c('usethis', 'pkgdown', 'testthat', 'roxygen2'))\""
init_hooks="echo 'DEBUG: Installing Python integration...'"
init_hooks="R -e \"install.packages('reticulate')\""
init_hooks="echo 'DEBUG: All R packages installed via r2u binaries!'"